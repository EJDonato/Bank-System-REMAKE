from datetime import datetime
import random

class CreateBankAccount:
    def create_account(self, email, password, first_name, last_name, birthdate, pin, monthly_salary, initial_balance):
        self.email = email
        self.password = password
        self.firstname = first_name
        self.lastname = last_name
        self.birthdate = birthdate  # i want the format to be in MM-DD-YYYY
        self.pin = pin
        self.monthly_salary = monthly_salary
        self.initial_balance = initial_balance
        self.account_number = None


    # check email and acc num duplication and insert data to database
    def insert_account_info(self):
        year = (str(datetime.today().date()))[2:4]
        digits = str(random.randint(100000, 999999))
        self.account_number = year + digits

        account_info = (self.firstname, self.lastname, self.birthdate, self.monthly_salary,
                        self.account_number, self.pin, self.initial_balance)
        login_info = (self.account_number, self.email, self.password)

        ## SQL QUERY ##
        check = insert_account_info(account_info, login_info)

        while check == "Account number DUPE":
            year = (str(datetime.today().date()))[2:4]
            digits = str(random.randint(100000, 999999))
            self.account_number = year + digits

            account_info = (self.firstname, self.lastname, self.birthdate, self.monthly_salary,
                            self.account_number, self.pin, self.initial_balance)
            login_info = (self.account_number, self.email, self.password)

            ## SQL QUERY ##
            check = insert_account_info(account_info, login_info)

        if check == "Email DUPE":
            return False  # EMAIL IS ALREADY EXISTING
        else:
            return True  #SIGNUP SUCCESSFULLY
